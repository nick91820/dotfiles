#!/usr/bin/env bash

# ~/.macos — https://mths.be/macos
# Modified by Nick J. Moss

# Close any open System Preferences panes, to prevent them from overriding
# settings we’re about to change
osascript -e 'tell application "System Preferences" to quit'

# Ask for the administrator password upfront
sudo -v

# Keep-alive: update existing `sudo` time stamp until `.macos` has finished
while true; 
  do sudo -n true; 
  sleep 60; 
  kill -0 "$$" || exit; 
  done 2>/dev/null &
#################################################################################################################################

###########################################
# Nick's Customizations                   #
###########################################
printf "
###############################################
# WELCOME TO MAC OS CONFIGURATION AND SET UP! #                                                   
###############################################

Hello $(whoami)! Let's get you all set up!

Things To Do Before You Continue:
  1. Sign in to iCloud and the App Store.
  2. Quit out of all applications that are open.

Press Enter to Continue
"
read
clear

printf "
Would you like to create a main folder for all of your code/projects? (y/n)
"
read input
if [[ ${input} == 'y' ]]
then 
  echo "What would you like that folder to be called?"
  read name
  mkdir -p "${HOME}/${name}"
  echo "${name} was created and placed in your ${HOME} directory\n"
  echo "Press Enter to Continue"
  read
  clear
else
fi

printf "
#########################
# HOMEBREW INSTALLATION #
#########################

Homebrew is a package manager for Mac OS. Homebrew can download packages of code/command line tools such
as 'youtube-dl', a video downloader for youtube videos. Homebrew can also install apps from the Mac App
Store through a package called 'mas'. And lastly, Homebrew can install apps that are not from the App Store
such as Spotify!

This part of the script will take you through installing certain packages and apps to your computer automatically.
First let's check if you have Homebrew installed already.
"
if [[ -d "/usr/local/Homebrew" ]]
then echo "It looks like Homebrew is already installed on your machine! Now let's install some things!

Press Enter to Continue\n"
read
clear
else
  echo "It looks like Homebrew is not installed on your machine. Let's get it installed!
  
  Press Enter to Continue\n"
  read
  clear
  # install homebrew https://brew.sh
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

#####################################
# INSTALLING PACKAGES WITH HOMEBREW #
#####################################

# Enter the desired packages into the PKG_LIST array below. Separate each package with a space.
# This will check if HomeBrew has already installed the package.
PKG_LIST=(mas wget python@3.9 youtube-dl node ffmpeg hub tree ripgrep)

printf "
#####################
# HOMEBREW PACKAGES #
#####################

I have a list of default packages that I install onto my machines within this script.
Those packages are:
  ${PKG_LIST}

I know that some users may want different packages or no packages at all so I have
provided the following options. Please enter the number of the option you would like.

(NOTE: You can also edit the package list inside the source code. Just search for PKG_LIST in
an editor and you can add or remove the packages you want and then you can come run this script
again and select option #1.)

OPTIONS:
  1. I would like to install the default list of packages provided.
  2. I would like to install the default list of packages and add some of my own.
  3. I don't want any of the default packages but I would like to add my own.
  4. I don't want to install any packages at this time.
"
read option
clear

if [[ ${option} == '1' ]]
then
  echo "\nbrew installing packages...\n"
  for PKG in ${PKG_LIST};
  do
    if [ -d "/usr/local/Cellar/${PKG}" ]
    then echo "${PKG} is already installed"
    else brew install ${PKG}
    fi
  done;
elif [[ ${option} == '2' ]]
then
  echo "\nPlease enter the names of the packages you would like Brew to install on one line like so: pkg1 pkg2 pkg3...pkgx
then press enter."
  read -A USER_LIST
  echo "\nbrew installing packages...\n"
  for PKG in ${PKG_LIST};
  do
    if [ -d "/usr/local/Cellar/${PKG}" ]
    then echo "${PKG} is already installed"
    else brew install ${PKG}
    fi
  done;

  for PKG in ${USER_LIST};
  do
    if [ -d "/usr/local/Cellar/${PKG}" ]
    then echo "${PKG} is already installed"
    else brew install ${PKG}
    fi
  done;
elif [[ ${option} == '3' ]]
then
  echo "\nPlease enter the names of the packages you would like Brew to install on one line like so: pkg1 pkg2 pkg3...pkgx
then press enter."
  read -A USER_LIST
  for PKG in ${USER_LIST};
  do
    if [ -d "/usr/local/Cellar/${PKG}" ]
    then echo "${PKG} is already installed"
    else brew install ${PKG}
    fi
  done;
else
fi




###################################################
# INSTALLING APPS NOT FROM APP STORE VIA HOMEBREW #
###################################################
declare -A BREW_LIST
BREW_LIST=( [Google\ Chrome]=google-chrome 
[Spotify]=spotify 
[iTerm]=iterm2 
[Visual Studio Code]=visual-studio-code 
[Sublime Text]=sublime-text 
[Discord]=discord 
[Handbrake]=handbrake
[Alfred]=alfred 
[Itsycal]=itsycal 
[Dash]=dash 
[WorkFlowy]=workflowy 
[Zoom]=zoom 
[RDM]=avibrazil-rdm 
[BetterZip]=betterzip 
[Github\ Desktop]=github 
)
clear
printf "
###########################
# APPS NOT FROM APP STORE #
###########################

I have a list of default apps that I install onto my machines within this script.
Those apps are:
  ${(k)BREW_LIST}

I know that some users may want different apps or no apps at all so I have
provided the following options. Please enter the number of the option you would like.

(NOTE: You can also edit the app list inside the source code. Just search for BREW_LIST in
an editor and you can add or remove the apps you want and then you can come run this script
again and select option #1.)

OPTIONS:
  1. I would like to install the default list of apps provided.
  2. I would like to install the default list of apps and add some of my own.
  3. I don't want any of the default apps but I would like to add my own.
  4. I don't want to install any apps at this time.
"
read input
clear

if [[ $input == '1' ]]
then
  echo "\ninstalling apps that are not from the App Store...\n"
  for BREW_APP in ${(k)BREW_LIST}; 
  do
    if [ -d "/Applications/${BREW_APP}.app" ]
    then echo "$BREW_APP is already installed"
    elif [ -d "$HOME/Applications/${BREW_APP}.app" ]
    then echo "$BREW_APP is already installed"
    else brew install --cask ${BREW_LIST[$BREW_APP]} 
    fi
  done;
elif [[ $input == '2' ]]
then
  printf "
  In order to install your apps you must know the app's formal name on your machine
  and the app's Homebrew formula name(the name that Homebrew uses to install the app).

  For example, if I wanted to install Spotify, Spotify's formal name on my computer is 'Spotify'
  but the Homebrew name for Spotify is simply 'spotify'. Typically if the app is only one
  word then the formal name is capitalized whereas the Homebrew name is lowercase(i.e. 'Zoom' and 'zoom').
  
  If the app has more than one word then typically the Homebrew name is lowercase and the words are
  separated by a hyphen '-'. For example, 'Visual Studio Code' is the name on my computer and the
  Homebrew name is 'visual-studio-code'. Please make sure you know both names before you continue.

  Press Enter to Continue
  "
  read
  clear

  printf "
  Please enter the name of your apps that you want to download. Please enter the formal name first and then
  the Homebrew name second as such:

  FormalName=HomebrewName

  For example:
  Spotify=spotify Zoom=zoom App=app...

  Please make sure to separate each app with a space, enter all the names of the apps you would like to install
  then press enter.
  "

  declare -A USER_APPS_LIST
  IFS="=' '"
  read -A apps
  clear
  for ((i = 1; i < ${#apps[@]}; i += 2))
  do
      USER_APPS_LIST[${apps[i]}]=${apps[i + 1]}
  done;

  echo "\ninstalling apps that are not from the App Store...\n"
  for BREW_APP in ${(k)BREW_LIST}; 
  do
    if [ -d "/Applications/${BREW_APP}.app" ]
    then echo "$BREW_APP is already installed"
    elif [ -d "$HOME/Applications/${BREW_APP}.app" ]
    then echo "$BREW_APP is already installed"
    else brew install --cask ${BREW_LIST[$BREW_APP]} 
    fi
  done;

  for USER_APP in ${(k)USER_APPS_LIST}; 
  do
    if [ -d "/Applications/${USER_APP}.app" ]
    then echo "$USER_APP is already installed"
    elif [ -d "$HOME/Applications/${USER_APP}.app" ]
    then echo "$USER_APP is already installed"
    else brew install --cask ${USER_APPS_LIST[$USER_APP]} 
    fi
  done;

elif [[ $input == '3' ]]
then
  printf "
  In order to install your apps you must know the app's formal name on your machine
  and the app's Homebrew formula name(the name that Homebrew uses to install the app).

  For example, if I wanted to install Spotify, Spotify's formal name on my computer is 'Spotify'
  but the Homebrew name for Spotify is simply 'spotify'. Typically if the app is only one
  word then the formal name is capitalized whereas the Homebrew name is lowercase(i.e. 'Zoom' and 'zoom').
  
  If the app has more than one word then typically the Homebrew name is lowercase and the words are
  separated by a hyphen '-'. For example, 'Visual Studio Code' is the name on my computer and the
  Homebrew name is 'visual-studio-code'. Please make sure you know both names before you continue.

  Press Enter to Continue
  "
  read
  clear

  printf "
  Please enter the name of your apps that you want to download. Please enter the formal name first and then
  the Homebrew name second as such:

  FormalName=HomebrewName

  For example:
  Spotify=spotify Zoom=zoom App=app...

  Please make sure to separate each app with a space, enter all the names of the apps you would like to install
  then press enter.
  "
  declare -A USER_APPS_LIST
  IFS="=' '"
  read -A apps
  clear
  for ((i = 1; i < ${#apps[@]}; i += 2))
  do
      USER_APPS_LIST[${apps[i]}]=${apps[i + 1]}
  done;
  
  echo "installing apps that are not from the App Store...\n"
  for USER_APP in ${(k)USER_APPS_LIST}; 
  do
    if [ -d "/Applications/${USER_APP}.app" ]
    then echo "$USER_APP is already installed"
    elif [ -d "$HOME/Applications/${USER_APP}.app" ]
    then echo "$USER_APP is already installed."
    else brew install --cask ${USER_APPS_LIST[$USER_APP]} 
    fi
  done;
else
fi



##################################
# INSTALLING APPS FROM APP STORE #
##################################
clear
# Add apps and their mas id to the associative array ex. myArray=([appName]=appId or appName appID) spaces in the app name must be escaped with '\'
declare -A APP_LIST
APP_LIST=( [Microsoft\ Excel]=462058435 
[Microsoft\ OneNote]=784801555 
[Microsoft\ Outlook]=985367838 
[Microsoft\ PowerPoint]=462062816 
[Microsoft\ Remote\ Desktop]=1295203466 
[Microsoft\ Word]=462054704 
[OneDrive]=823766827 )
printf "
###########################
# APPS FROM APP STORE #
###########################
In order to install apps from the App Store we are going to use a package we just
installed called 'mas', which stands for Mac App Store. This command line tool
allows you to search, install, and update apps from the App Store. Each app has a
unique mas ID that we will use to install the apps we want.

I have a list of default apps that I install onto my machines within this script.
Those apps are:
  ${(k)APP_LIST}

I know that some users may want different apps or no apps at all so I have
provided the following options. Make sure you are signed into iCloud and the
App Store before continuing.

Please enter the number of the option you would like.

OPTIONS:
  1. I would like to install the default list of apps provided.
  2. I would like to install the default list of apps and add some of my own.
  3. I don't want any of the default apps but I would like to add my own.
  4. I don't want to install any apps at this time.

(NOTE: You can also edit the app list inside the source code. Just search for APP_LIST in
an editor and you can add or remove the apps you want and then you can come run this script
again and select option #1.)
"
read input
clear

if [[ $input == '1' ]]
then
  echo "installing apps from the App Store..."
  for APP in ${(k)APP_LIST}; 
  do
    if [ -d "/Applications/${APP}.app" ]
    then echo "$APP is already installed"
    else mas install ${APP_LIST[$APP]} 
    fi
  done;
elif [[ $input == '2' ]]
then
  printf "
  In order to install your apps, you need to know the name of your app and its mas ID.
  If you do not know your app's mas ID, I suggest you open a new terminal window(cmd+N)
  and enter the command 'mas search yourApp' to search for your app and it's ID.

  Please enter your app's name and mas ID just like the example below:

  OneDrive=823766827  Microsoft\ Word=462054704

  Make sure to separate each app with a space and if an app's name contains spaces please
  escape those spaces with '\'.
  "


# Hide last session information that appears each time a new shell session is started
if [ -f "${HOME}/.hushlogin"]
then echo "file .hushlogin already exists"
else cd ${HOME}
touch .hushlogin
fi

# Check the node and npm versions and print it to console
echo "node --version: $(node --version)"
echo "npm --version: $(npm --version)"

echo "installing a few global npm packages"
npm install --global serve fkill-cli npm-quick-run \
semantic-release-cli npm-check-updates
############################################################################################

#######################################
# GITHUB AUTHENTICATION AND FILE COPY #
#######################################
printf "
###########################################
# GITHUB AUTHENTICATION AND FILE DOWNLOAD #
###########################################
GitHub Authentication:
  Would you like the script to authenticate your GitHub account for you with SSH? (y/n)

  This will allow you to push and pull commits to and from GitHub without having to
  enter your username and password each time.
"
read input
if [[ ${input} == 'y' ]]
then
  echo "\nGenerating SSH key for Github authentication..."
  if [ -f "${HOME}/.ssh/configs" ]
  then
    printf "
    ${HOME}/.ssh/config already exists.
    Check to see if your SSH key is already stored in ${HOME}/.ssh
    The file should be called 'id_ed25519'

    If the file exists enter 'y' if not enter 'n':
    "
    read input
    if [[ ${input} == 'y' ]]
    then
      echo "\nSince the file exists, let's configure it for SSH...\n"
      echo "Please verify that ${HOME}/.ssh/config looks exactly like this: (y/n)\n"
      echo "Host *\n AddKeysToAgent yes\n UseKeychain yes\n IdentityFile ~/.ssh/id_ed25519" | tee ~/.ssh/config
      read input
      if [[ ${input} == 'y' ]]
      then
        eval "$(ssh-agent -s)"
        ssh-add -K ~/.ssh/id_ed25519
        printf "
        Your SSH key has now been added to the key agent on your computer.
        This will now allow you to push and pull commits to and from GitHub without having to sign in each time.

        (Note: Some SSH keys are protected with a passphrase that the user sets up. If you do not remember the
        passphrase and/or do not have it stored in your computers keychain then you may need to generate a new
        SSH key.)
        
        IMPORTANT: Please look at the To-Do list that will be displayed after this script runs for important next steps.

        Press Enter to Continue
        "
        read
      else
        printf "
        Please refer to GitHub's documentation on 'SSH Keys' for more help.

        Here is the link, please look through each page about SSH Keys listed in the nav menu on the left of the page:
        https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/about-ssh

        I suggest you set up your SSH authentication manually with help from GitHub's Documentation and then come back
        and run this script and enter 'n' when prompted to set up GitHub authentication.
        "
      fi
    else
      printf "
      We are going to now generate an SSH key that will be associated with your email.

      This is an email that will be associated with your commits to GitHub, this can be
      your GitHub email(preferred) or another email.

      When generating the key, it will prompt you for a passphrase. This passphrase is to
      protect your key and this passphrase will then be stored in your computer's keychain
      so you won't need to enter it each time you try to access GitHub.

      Please enter your email:
      "
      read email
      ssh-keygen -t ed25519 -C "${email}"
      
      echo "\nPlease verify that ${HOME}/.ssh/config looks exactly like this?\n"
      echo "Host *\n AddKeysToAgent yes\n UseKeychain yes\n IdentityFile ~/.ssh/id_ed25519" | tee ~/.ssh/config
      echo "\nIf it does not look like this please copy and paste this text above and place it into the config file."
      echo '\nPress Enter to Continue'
      read

      printf "
      Your SSH key has now been added to the key agent on your computer.
      This will now allow you to push and pull commits to and from GitHub without having to sign in each time.
      
      IMPORTANT: Please look at the To-Do list that will be displayed after this script runs for important next steps.

      Press Enter to Continue
      "
      read
      fi
  else 
    printf "
    Creating ~/.ssh/config file...
    "
    touch ~/.ssh/config

    printf "
    We are going to now generate an SSH key that will be associated with your email.

    This is an email that will be associated with your commits to GitHub, this can be
    your GitHub email(preferred) or another email.

    When generating the key, it will prompt you for a passphrase. This passphrase is to
    protect your key and this passphrase will then be stored in your computer's keychain
    so you won't need to enter it each time you try to access GitHub.

    Please enter your email:
    "
    read email
    ssh-keygen -t ed25519 -C "${email}"
    echo "Host *\n AddKeysToAgent yes\n UseKeychain yes\n IdentityFile ~/.ssh/id_ed25519" | tee ~/.ssh/config
    eval "$(ssh-agent -s)"
    ssh-add -K ~/.ssh/id_ed25519
    printf "
    Your SSH key has now been added to the key agent on your computer.
    This will now allow you to push and pull commits to and from GitHub without having to sign in each time.

    (Note: Some SSH keys are protected with a passphrase that the user sets up. If you do not remember the
    passphrase and/or do not have it stored in your computers keychain then you may need to generate a new
    SSH key.)
    
    IMPORTANT: Please look at the To-Do list that will be displayed after this script runs for important next steps.

    Press Enter to Continue
    "
    read
  fi
else
fi

# Clones the repository containing all the dotfiles and symlinks them to the original files in the home directory.
# Now when a program refers to the hoe dotfiles they are now pointing to the custom dotfiles cloned from the repo.
printf "
Dotfiles Download:
  If you have other configuration files (i.e. .gitconfig, .zshrc, .gitignore_global) that you would like to download,
  this script will download them for you and make them your default configuration files.

  To download the files enter your GitHub username:
  
  Otherwise hit Enter
"
read user
if [[ $user ]]
then
  echo "Please enter the name of the repo where your files are:"
  read repo
  git clone git@github.com:${user}/${repo}.git "${HOME}/dotfiles"
  ln -s "${HOME}/dotfiles/.zshrc" "${HOME}/.zshrc"
  ln -s "${HOME}/dotfiles/.gitignore_global" "${HOME}/.gitignore_global"
  ln -s "${HOME}/dotfiles/.gitconfig" "${HOME}/.gitconfig"
  ln -s "${HOME}/dotfiles/.my_bin" "${HOME}/.my_bin"
  ln -s "${HOME}/dotfiles/.vimrc" "${HOME}/.vimrc"
  ln -s "${HOME}/dotfiles/.vimrc-parts" "${HOME}/.vimrc-parts"
  ln -s "${HOME}/dotfiles/.ripgreprc" "${HOME}/.ripgreprc"

  printf "
  All of your configuration files were downloaded and have been set as the default
  configurations. Each file is located in the ${HOME}/dotfiles directory.

  Press Enter to Continue
  "
  read
else
fi
#######################################################################################

##############################################
# WELCOME TO THE SYSTEM PREFERENCES SETTINGS #
##############################################

printf "
##############################################
# WELCOME TO THE SYSTEM PREFERENCES SETTINGS #
##############################################

I have curated a number of modifications to the Mac OS preferences. Some of these preferences can be adjusted
through System Preferences but there are many that are hidden unless done through the command line. This script
adjust both and does it automatically. 

If you would like to check out the list of preferences or make adjustments of your own, look at the the code for
this script in GitHub or download it and look at it in a text editor. Each person is different so I don't expect
everyone to have the same preferences as I do, feel free to make changes.

To learn how to adjust these settings, I suggest reading this article to get started and then find similar tutorials
online:
  https://pawelgrzybek.com/change-macos-user-preferences-via-command-line/

Press Enter to Continue 
or 
Enter 'q' to Quit
"
read input
if [[ ${input} ]]
then exit
else
fi

# Make Chrome Two finger swipe for back and forward
defaults write com.google.Chrome AppleEnableSwipeNavigateWithScrolls -bool TRUE

###############################################################################
# General UI/UX                                                               #
###############################################################################

# Set standby delay to 24 hours (default is 1 hour)
sudo pmset -a standbydelay 86400

# Disable the sound effects on boot
sudo nvram SystemAudioVolume=" "

# Set highlight color to green
# defaults write NSGlobalDomain AppleHighlightColor -string "0.764700 0.976500 0.568600"

# Set sidebar icon size to medium
# defaults write NSGlobalDomain NSTableViewDefaultSizeMode -int 2

# Always show scrollbars
# defaults write NSGlobalDomain AppleShowScrollBars -string "Always"
# Possible values: `WhenScrolling`, `Automatic` and `Always`

# Disable the over-the-top focus ring animation
# defaults write NSGlobalDomain NSUseAnimatedFocusRing -bool false

# Disable smooth scrolling
# (Uncomment if you’re on an older Mac that messes up the animation)
#defaults write NSGlobalDomain NSScrollAnimationEnabled -bool false

# Increase window resize speed for Cocoa applications
# defaults write NSGlobalDomain NSWindowResizeTime -float 0.001

# Expand save panel by default
defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode -bool true
defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode2 -bool true

# Expand print panel by default
defaults write NSGlobalDomain PMPrintingExpandedStateForPrint -bool true
defaults write NSGlobalDomain PMPrintingExpandedStateForPrint2 -bool true

# Save to disk (not to iCloud) by default
defaults write NSGlobalDomain NSDocumentSaveNewDocumentsToCloud -bool false

# Automatically quit printer app once the print jobs complete
defaults write com.apple.print.PrintingPrefs "Quit When Finished" -bool true

# Disable the “Are you sure you want to open this application?” dialog
defaults write com.apple.LaunchServices LSQuarantine -bool false

# Remove duplicates in the “Open With” menu (also see `lscleanup` alias)
/System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Support/lsregister -kill -r -domain local -domain system -domain user

# Display ASCII control characters using caret notation in standard text views
# Try e.g. `cd /tmp; unidecode "\x{0000}" > cc.txt; open -e cc.txt`
# defaults write NSGlobalDomain NSTextShowsControlCharacters -bool true

# Disable Resume system-wide
# defaults write com.apple.systempreferences NSQuitAlwaysKeepsWindows -bool false

# Disable automatic termination of inactive apps
# defaults write NSGlobalDomain NSDisableAutomaticTermination -bool true

# Disable the crash reporter
defaults write com.apple.CrashReporter DialogType -string "none"

# Set Help Viewer windows to non-floating mode
defaults write com.apple.helpviewer DevMode -bool true

# Fix for the ancient UTF-8 bug in QuickLook (https://mths.be/bbo)
# Commented out, as this is known to cause problems in various Adobe apps :(
# See https://github.com/mathiasbynens/dotfiles/issues/237
#echo "0x08000100:0" > ~/.CFUserTextEncoding

# Reveal IP address, hostname, OS version, etc. when clicking the clock
# in the login window
sudo defaults write /Library/Preferences/com.apple.loginwindow AdminHostInfo HostName

# Restart automatically if the computer freezes
# sudo systemsetup -setrestartfreeze on

# Never go into computer sleep mode
sudo systemsetup -setcomputersleep Off > /dev/null

# Disable Notification Center and remove the menu bar icon
# launchctl unload -w /System/Library/LaunchAgents/com.apple.notificationcenterui.plist 2> /dev/null

# Disable automatic capitalization as it’s annoying when typing code
defaults write NSGlobalDomain NSAutomaticCapitalizationEnabled -bool false

# Disable smart dashes as they’re annoying when typing code
defaults write NSGlobalDomain NSAutomaticDashSubstitutionEnabled -bool false

# Disable automatic period substitution as it’s annoying when typing code
defaults write NSGlobalDomain NSAutomaticPeriodSubstitutionEnabled -bool false

# Disable smart quotes as they’re annoying when typing code
defaults write NSGlobalDomain NSAutomaticQuoteSubstitutionEnabled -bool false

# Disable auto-correct
defaults write NSGlobalDomain NSAutomaticSpellingCorrectionEnabled -bool false

# Set a custom wallpaper image. `DefaultDesktop.jpg` is already a symlink, and
# all wallpapers are in `/Library/Desktop Pictures/`. The default is `Wave.jpg`.
#rm -rf ~/Library/Application Support/Dock/desktoppicture.db
#sudo rm -rf /System/Library/CoreServices/DefaultDesktop.jpg
#sudo ln -s /path/to/your/image /System/Library/CoreServices/DefaultDesktop.jpg

###############################################################################
# SSD-specific tweaks                                                         #
###############################################################################

# Disable hibernation (speeds up entering sleep mode)
# sudo pmset -a hibernatemode 0

# Remove the sleep image file to save disk space
# sudo rm /private/var/vm/sleepimage
# Create a zero-byte file instead…
# sudo touch /private/var/vm/sleepimage
# …and make sure it can’t be rewritten
# sudo chflags uchg /private/var/vm/sleepimage

###############################################################################
# Trackpad, mouse, keyboard, Bluetooth accessories, and input                 #
###############################################################################

# Trackpad: enable tap to click for this user and for the login screen
defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad Clicking -bool true
defaults -currentHost write NSGlobalDomain com.apple.mouse.tapBehavior -int 1
defaults write NSGlobalDomain com.apple.mouse.tapBehavior -int 1

# enable three finger drag on trackpad
defaults write http://com.apple.driver.AppleBluetoothMultitouch.trackpad TrackpadThreeFingerDrag -int 1
defaults write http://com.apple.AppleMultitouchTrackpad TrackpadThreeFingerDrag -int 1

# Trackpad: map bottom right corner to right-click
# defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad TrackpadCornerSecondaryClick -int 2
# defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad TrackpadRightClick -bool true
# defaults -currentHost write NSGlobalDomain com.apple.trackpad.trackpadCornerClickBehavior -int 1
# defaults -currentHost write NSGlobalDomain com.apple.trackpad.enableSecondaryClick -bool true

# Disable “natural” (Lion-style) scrolling
# defaults write NSGlobalDomain com.apple.swipescrolldirection -bool false

# Increase sound quality for Bluetooth headphones/headsets
# defaults write com.apple.BluetoothAudioAgent "Apple Bitpool Min (editable)" -int 40

# Enable full keyboard access for all controls
# (e.g. enable Tab in modal dialogs)
defaults write NSGlobalDomain AppleKeyboardUIMode -int 2

# Use scroll gesture with the Ctrl (^) modifier key to zoom
defaults write com.apple.universalaccess closeViewScrollWheelToggle -bool true
defaults write com.apple.universalaccess HIDScrollZoomModifierMask -int 262144
# Follow the keyboard focus while zoomed in
# defaults write com.apple.universalaccess closeViewZoomFollowsFocus -bool true

# Disable press-and-hold for keys in favor of key repeat
defaults write NSGlobalDomain ApplePressAndHoldEnabled -bool false

# Set a blazingly fast keyboard repeat rate
defaults write NSGlobalDomain KeyRepeat -int 1
defaults write NSGlobalDomain InitialKeyRepeat -int 10

# Set language and text formats
# Note: if you’re in the US, replace `EUR` with `USD`, `Centimeters` with
# `Inches`, `en_GB` with `en_US`, and `true` with `false`.
# defaults write NSGlobalDomain AppleLanguages -array "en" "nl"
# defaults write NSGlobalDomain AppleLocale -string "en_GB@currency=EUR"
# defaults write NSGlobalDomain AppleMeasurementUnits -string "Centimeters"
# defaults write NSGlobalDomain AppleMetricUnits -bool true

# Show language menu in the top right corner of the boot screen
# sudo defaults write /Library/Preferences/com.apple.loginwindow showInputMenu -bool true

# Set the timezone; see `sudo systemsetup -listtimezones` for other values
# sudo systemsetup -settimezone "Europe/Brussels" > /dev/null

# Stop iTunes from responding to the keyboard media keys
#launchctl unload -w /System/Library/LaunchAgents/com.apple.rcd.plist 2> /dev/null

###############################################################################
# Screen                                                                      #
###############################################################################

# Require password immediately after sleep or screen saver begins
defaults write com.apple.screensaver askForPassword -int 1
defaults write com.apple.screensaver askForPasswordDelay -int 0

# Save screenshots to the desktop
defaults write com.apple.screencapture location -string "${HOME}/Desktop"

# Save screenshots in PNG format (other options: BMP, GIF, JPG, PDF, TIFF)
defaults write com.apple.screencapture type -string "png"

# Disable shadow in screenshots
# defaults write com.apple.screencapture disable-shadow -bool true

# Enable subpixel font rendering on non-Apple LCDs
# Reference: https://github.com/kevinSuttle/macOS-Defaults/issues/17#issuecomment-266633501
defaults write NSGlobalDomain AppleFontSmoothing -int 1

# Enable HiDPI display modes (requires restart)
sudo defaults write /Library/Preferences/com.apple.windowserver DisplayResolutionEnabled -bool true

###############################################################################
# Finder                                                                      #
###############################################################################

# Finder: allow quitting via ⌘ + Q; doing so will also hide desktop icons
defaults write com.apple.finder QuitMenuItem -bool true

# Finder: disable window animations and Get Info animations
# defaults write com.apple.finder DisableAllAnimations -bool true

# Set Desktop as the default location for new Finder windows
# For other paths, use `PfLo` and `file:///full/path/here/`
defaults write com.apple.finder NewWindowTarget -string "PfDe"
defaults write com.apple.finder NewWindowTargetPath -string "file://${HOME}/Desktop/"

# Show icons for hard drives, servers, and removable media on the desktop
defaults write com.apple.finder ShowExternalHardDrivesOnDesktop -bool true
defaults write com.apple.finder ShowHardDrivesOnDesktop -bool false
defaults write com.apple.finder ShowMountedServersOnDesktop -bool false
defaults write com.apple.finder ShowRemovableMediaOnDesktop -bool true

# Finder: show hidden files by default
#defaults write com.apple.finder AppleShowAllFiles -bool true

# Finder: show all filename extensions
defaults write NSGlobalDomain AppleShowAllExtensions -bool true

# Finder: show status bar
defaults write com.apple.finder ShowStatusBar -bool true

# Finder: show path bar
defaults write com.apple.finder ShowPathbar -bool true

# Display full POSIX path as Finder window title
defaults write com.apple.finder _FXShowPosixPathInTitle -bool true

# Keep folders on top when sorting by name
defaults write com.apple.finder _FXSortFoldersFirst -bool true

# When performing a search, search the current folder by default
defaults write com.apple.finder FXDefaultSearchScope -string "SCcf"

# Disable the warning when changing a file extension
defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false

# Enable spring loading for directories
defaults write NSGlobalDomain com.apple.springing.enabled -bool true

# Reduce the spring loading delay for directories
defaults write NSGlobalDomain com.apple.springing.delay -float 0.2

# Avoid creating .DS_Store files on network or USB volumes
defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true
defaults write com.apple.desktopservices DSDontWriteUSBStores -bool true

# Disable disk image verification
defaults write com.apple.frameworks.diskimages skip-verify -bool true
defaults write com.apple.frameworks.diskimages skip-verify-locked -bool true
defaults write com.apple.frameworks.diskimages skip-verify-remote -bool true

# Automatically open a new Finder window when a volume is mounted
defaults write com.apple.frameworks.diskimages auto-open-ro-root -bool true
defaults write com.apple.frameworks.diskimages auto-open-rw-root -bool true
defaults write com.apple.finder OpenWindowForNewRemovableDisk -bool true

# Show item info near icons on the desktop and in other icon views
# /usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:showItemInfo true" ~/Library/Preferences/com.apple.finder.plist
# /usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:showItemInfo true" ~/Library/Preferences/com.apple.finder.plist
# /usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:showItemInfo true" ~/Library/Preferences/com.apple.finder.plist

# Show item info to the right of the icons on the desktop
# /usr/libexec/PlistBuddy -c "Set DesktopViewSettings:IconViewSettings:labelOnBottom false" ~/Library/Preferences/com.apple.finder.plist

# Enable snap-to-grid for icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:arrangeBy grid" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:arrangeBy grid" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:arrangeBy grid" ~/Library/Preferences/com.apple.finder.plist

# Increase grid spacing for icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:gridSpacing 100" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:gridSpacing 100" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:gridSpacing 100" ~/Library/Preferences/com.apple.finder.plist

# Increase the size of icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:iconSize 56" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:iconSize 56" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:iconSize 56" ~/Library/Preferences/com.apple.finder.plist

# Use column view in all Finder windows by default
# Four-letter codes for the other view modes: `icnv`, `clmv`, `Flwv`, `Nlsv`
defaults write com.apple.finder FXPreferredViewStyle -string "clmv"

# Disable the warning before emptying the Trash
defaults write com.apple.finder WarnOnEmptyTrash -bool false

# Enable AirDrop over Ethernet and on unsupported Macs running Lion
defaults write com.apple.NetworkBrowser BrowseAllInterfaces -bool true

# Show the ~/Library folder
chflags nohidden ~/Library

# Show the /Volumes folder
sudo chflags nohidden /Volumes

# Remove Dropbox’s green checkmark icons in Finder
# file=/Applications/Dropbox.app/Contents/Resources/emblem-dropbox-uptodate.icns
# [ -e "${file}" ] && mv -f "${file}" "${file}.bak"

# Expand the following File Info panes:
# “General”, “Open with”, and “Sharing & Permissions”
defaults write com.apple.finder FXInfoPanesExpanded -dict \
  General -bool true \
  OpenWith -bool true \
  Privileges -bool true

###############################################################################
# Dock, Dashboard, and hot corners                                            #
###############################################################################

# Enable highlight hover effect for the grid view of a stack (Dock)
defaults write com.apple.dock mouse-over-hilite-stack -bool true

# Set the icon size of Dock items to 16 pixels
defaults write com.apple.dock tilesize -int 16

# Change minimize/maximize window effect
defaults write com.apple.dock mineffect -string "scale"

# Minimize windows into their application’s icon
defaults write com.apple.dock minimize-to-application -bool true

# Enable spring loading for all Dock items
defaults write com.apple.dock enable-spring-load-actions-on-all-items -bool true

# Show indicator lights for open applications in the Dock
defaults write com.apple.dock show-process-indicators -bool true

# Wipe all (default) app icons from the Dock
# This is only really useful when setting up a new Mac, or if you don’t use
# the Dock to launch apps.
defaults write com.apple.dock persistent-apps -array

# Show only open applications in the Dock
defaults write com.apple.dock static-only -bool true

# Don’t animate opening applications from the Dock
defaults write com.apple.dock launchanim -bool false

# Speed up Mission Control animations
defaults write com.apple.dock expose-animation-duration -float 0.1

# Don’t group windows by application in Mission Control
# (i.e. use the old Exposé behavior instead)
# defaults write com.apple.dock expose-group-by-app -bool false

# Disable Dashboard
# defaults write com.apple.dashboard mcx-disabled -bool true

# Don’t show Dashboard as a Space
# defaults write com.apple.dock dashboard-in-overlay -bool true

# Don’t automatically rearrange Spaces based on most recent use
# defaults write com.apple.dock mru-spaces -bool false

# Remove the auto-hiding Dock delay
# defaults write com.apple.dock autohide-delay -float 0
# Remove the animation when hiding/showing the Dock
# defaults write com.apple.dock autohide-time-modifier -float 0

# Automatically hide and show the Dock
defaults write com.apple.dock autohide -bool true

# Make Dock icons of hidden applications translucent
defaults write com.apple.dock showhidden -bool true

# Disable the Launchpad gesture (pinch with thumb and three fingers)
defaults write com.apple.dock showLaunchpadGestureEnabled -int 0

# Reset Launchpad, but keep the desktop wallpaper intact
# find "${HOME}/Library/Application Support/Dock" -name "*-*.db" -maxdepth 1 -delete

# Add iOS & Watch Simulator to Launchpad
# sudo ln -sf "/Applications/Xcode.app/Contents/Developer/Applications/Simulator.app" "/Applications/Simulator.app"
# sudo ln -sf "/Applications/Xcode.app/Contents/Developer/Applications/Simulator (Watch).app" "/Applications/Simulator (Watch).app"

# Add a spacer to the left side of the Dock (where the applications are)
#defaults write com.apple.dock persistent-apps -array-add '{tile-data={}; tile-type="spacer-tile";}'
# Add a spacer to the right side of the Dock (where the Trash is)
#defaults write com.apple.dock persistent-others -array-add '{tile-data={}; tile-type="spacer-tile";}'

# Hot corners
# Possible values:
#  0: no-op
#  2: Mission Control
#  3: Show application windows
#  4: Desktop
#  5: Start screen saver
#  6: Disable screen saver
#  7: Dashboard
# 10: Put display to sleep
# 11: Launchpad
# 12: Notification Center
# 1048576 is ⌘ I think
# Top left screen corner → Desktop
defaults write com.apple.dock wvous-tl-corner -int 4
defaults write com.apple.dock wvous-tl-modifier -int 1048576
# Top right screen corner → Desktop
defaults write com.apple.dock wvous-tr-corner -int 4
defaults write com.apple.dock wvous-tr-modifier -int 1048576
# Bottom left screen corner → Start screen saver
defaults write com.apple.dock wvous-bl-corner -int 5
defaults write com.apple.dock wvous-bl-modifier -int 1048576
# Bottom right screen corner → Put display to sleep
defaults write com.apple.dock wvous-br-corner -int 10
defaults write com.apple.dock wvous-br-modifier -int 1048576

###############################################################################
# Safari & WebKit                                                             #
###############################################################################

# Privacy: don’t send search queries to Apple
defaults write com.apple.Safari UniversalSearchEnabled -bool false
defaults write com.apple.Safari SuppressSearchSuggestions -bool true

# Press Tab to highlight each item on a web page
defaults write com.apple.Safari WebKitTabToLinksPreferenceKey -bool true
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2TabsToLinks -bool true

# Show the full URL in the address bar (note: this still hides the scheme)
defaults write com.apple.Safari ShowFullURLInSmartSearchField -bool true

# Set Safari’s home page to `about:blank` for faster loading
defaults write com.apple.Safari HomePage -string "about:blank"

# Prevent Safari from opening ‘safe’ files automatically after downloading
defaults write com.apple.Safari AutoOpenSafeDownloads -bool false

# Allow hitting the Backspace key to go to the previous page in history
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2BackspaceKeyNavigationEnabled -bool true

# Hide Safari’s bookmarks bar by default
defaults write com.apple.Safari ShowFavoritesBar -bool false

# Hide Safari’s sidebar in Top Sites
defaults write com.apple.Safari ShowSidebarInTopSites -bool false

# Disable Safari’s thumbnail cache for History and Top Sites
defaults write com.apple.Safari DebugSnapshotsUpdatePolicy -int 2

# Enable Safari’s debug menu
defaults write com.apple.Safari IncludeInternalDebugMenu -bool true

# Make Safari’s search banners default to Contains instead of Starts With
defaults write com.apple.Safari FindOnPageMatchesWordStartsOnly -bool false

# Remove useless icons from Safari’s bookmarks bar
defaults write com.apple.Safari ProxiesInBookmarksBar "()"

# Enable the Develop menu and the Web Inspector in Safari
defaults write com.apple.Safari IncludeDevelopMenu -bool true
defaults write com.apple.Safari WebKitDeveloperExtrasEnabledPreferenceKey -bool true
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2DeveloperExtrasEnabled -bool true

# Add a context menu item for showing the Web Inspector in web views
defaults write NSGlobalDomain WebKitDeveloperExtras -bool true

# Enable continuous spellchecking
defaults write com.apple.Safari WebContinuousSpellCheckingEnabled -bool true
# Disable auto-correct
defaults write com.apple.Safari WebAutomaticSpellingCorrectionEnabled -bool false

# Disable AutoFill
defaults write com.apple.Safari AutoFillFromAddressBook -bool false
defaults write com.apple.Safari AutoFillPasswords -bool false
defaults write com.apple.Safari AutoFillCreditCardData -bool false
defaults write com.apple.Safari AutoFillMiscellaneousForms -bool false

# Warn about fraudulent websites
defaults write com.apple.Safari WarnAboutFraudulentWebsites -bool true

# Disable plug-ins
defaults write com.apple.Safari WebKitPluginsEnabled -bool false
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2PluginsEnabled -bool false

# Disable Java
defaults write com.apple.Safari WebKitJavaEnabled -bool false
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2JavaEnabled -bool false

# Block pop-up windows
defaults write com.apple.Safari WebKitJavaScriptCanOpenWindowsAutomatically -bool false
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2JavaScriptCanOpenWindowsAutomatically -bool false

# Disable auto-playing video
defaults write com.apple.Safari WebKitMediaPlaybackAllowsInline -bool false
defaults write com.apple.SafariTechnologyPreview WebKitMediaPlaybackAllowsInline -bool false
defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2AllowsInlineMediaPlayback -bool false
defaults write com.apple.SafariTechnologyPreview com.apple.Safari.ContentPageGroupIdentifier.WebKit2AllowsInlineMediaPlayback -bool false

# Enable “Do Not Track”
defaults write com.apple.Safari SendDoNotTrackHTTPHeader -bool true

# Update extensions automatically
defaults write com.apple.Safari InstallExtensionUpdatesAutomatically -bool true

###############################################################################
# Mail                                                                        #
###############################################################################

# Disable send and reply animations in Mail.app
# defaults write com.apple.mail DisableReplyAnimations -bool true
# defaults write com.apple.mail DisableSendAnimations -bool true

# Copy email addresses as `foo@example.com` instead of `Foo Bar <foo@example.com>` in Mail.app
defaults write com.apple.mail AddressesIncludeNameOnPasteboard -bool false

# Add the keyboard shortcut ⌘ + Enter to send an email in Mail.app
# defaults write com.apple.mail NSUserKeyEquivalents -dict-add "Send" "@\U21a9"

# Display emails in threaded mode, sorted by date (oldest at the top)
defaults write com.apple.mail DraftsViewerAttributes -dict-add "DisplayInThreadedMode" -string "yes"
# defaults write com.apple.mail DraftsViewerAttributes -dict-add "SortedDescending" -string "yes"
# defaults write com.apple.mail DraftsViewerAttributes -dict-add "SortOrder" -string "received-date"

# Disable inline attachments (just show the icons)
# defaults write com.apple.mail DisableInlineAttachmentViewing -bool true

# Disable automatic spell checking
# defaults write com.apple.mail SpellCheckingBehavior -string "NoSpellCheckingEnabled"

###############################################################################
# Spotlight                                                                   #
###############################################################################

# Hide Spotlight tray-icon (and subsequent helper)
sudo chmod 600 /System/Library/CoreServices/Search.bundle/Contents/MacOS/Search
# Disable Spotlight indexing for any volume that gets mounted and has not yet
# been indexed before.
# Use `sudo mdutil -i off "/Volumes/foo"` to stop indexing any volume.
sudo defaults write /.Spotlight-V100/VolumeConfiguration Exclusions -array "/Volumes"
# Change indexing order and disable some search results
# Yosemite-specific search results (remove them if you are using macOS 10.9 or older):
#   MENU_DEFINITION
#   MENU_CONVERSION
#   MENU_EXPRESSION
#   MENU_SPOTLIGHT_SUGGESTIONS (send search queries to Apple)
#   MENU_WEBSEARCH             (send search queries to Apple)
#   MENU_OTHER
defaults write com.apple.spotlight orderedItems -array \
  '{"enabled" = 1;"name" = "APPLICATIONS";}' \
  '{"enabled" = 1;"name" = "SYSTEM_PREFS";}' \
  '{"enabled" = 1;"name" = "DIRECTORIES";}' \
  '{"enabled" = 1;"name" = "PDF";}' \
  '{"enabled" = 1;"name" = "FONTS";}' \
  '{"enabled" = 0;"name" = "DOCUMENTS";}' \
  '{"enabled" = 0;"name" = "MESSAGES";}' \
  '{"enabled" = 0;"name" = "CONTACT";}' \
  '{"enabled" = 0;"name" = "EVENT_TODO";}' \
  '{"enabled" = 0;"name" = "IMAGES";}' \
  '{"enabled" = 0;"name" = "BOOKMARKS";}' \
  '{"enabled" = 0;"name" = "MUSIC";}' \
  '{"enabled" = 0;"name" = "MOVIES";}' \
  '{"enabled" = 0;"name" = "PRESENTATIONS";}' \
  '{"enabled" = 0;"name" = "SPREADSHEETS";}' \
  '{"enabled" = 0;"name" = "SOURCE";}' \
  '{"enabled" = 0;"name" = "MENU_DEFINITION";}' \
  '{"enabled" = 0;"name" = "MENU_OTHER";}' \
  '{"enabled" = 0;"name" = "MENU_CONVERSION";}' \
  '{"enabled" = 0;"name" = "MENU_EXPRESSION";}' \
  '{"enabled" = 0;"name" = "MENU_WEBSEARCH";}' \
  '{"enabled" = 0;"name" = "MENU_SPOTLIGHT_SUGGESTIONS";}'
# Load new settings before rebuilding the index
killall mds > /dev/null 2>&1
# Make sure indexing is enabled for the main volume
sudo mdutil -i on / > /dev/null
# Rebuild the index from scratch
sudo mdutil -E / > /dev/null

###############################################################################
# Terminal & iTerm 2                                                          #
###############################################################################

# Only use UTF-8 in Terminal.app
defaults write com.apple.terminal StringEncodings -array 4

# Use a modified version of the Solarized Dark theme by default in Terminal.app
# osascript <<EOD
# tell application "Terminal"
#   local allOpenedWindows
#   local initialOpenedWindows
#   local windowID
#   set themeName to "Solarized Dark xterm-256color"
#   (* Store the IDs of all the open terminal windows. *)
#   set initialOpenedWindows to id of every window
#   (* Open the custom theme so that it gets added to the list
#      of available terminal themes (note: this will open two
#      additional terminal windows). *)
#   do shell script "open '$HOME/init/" & themeName & ".terminal'"
#   (* Wait a little bit to ensure that the custom theme is added. *)
#   delay 1
#   (* Set the custom theme as the default terminal theme. *)
#   set default settings to settings set themeName
#   (* Get the IDs of all the currently opened terminal windows. *)
#   set allOpenedWindows to id of every window
#   repeat with windowID in allOpenedWindows
#     (* Close the additional windows that were opened in order
#        to add the custom theme to the list of terminal themes. *)
#     if initialOpenedWindows does not contain windowID then
#       close (every window whose id is windowID)
#     (* Change the theme for the initial opened terminal windows
#        to remove the need to close them in order for the custom
#        theme to be applied. *)
#     else
#       set current settings of tabs of (every window whose id is windowID) to settings set themeName
#     end if
#   end repeat
# end tell
# EOD

# Enable “focus follows mouse” for Terminal.app and all X11 apps
# i.e. hover over a window and start typing in it without clicking first
#defaults write com.apple.terminal FocusFollowsMouse -bool true
#defaults write org.x.X11 wm_ffm -bool true

# Enable Secure Keyboard Entry in Terminal.app
# See: https://security.stackexchange.com/a/47786/8918
defaults write com.apple.terminal SecureKeyboardEntry -bool true

# Disable the annoying line marks
defaults write com.apple.Terminal ShowLineMarks -int 0

# Install the Solarized Dark theme for iTerm
# open "${HOME}/init/Solarized Dark.itermcolors"

# Don’t display the annoying prompt when quitting iTerm
# defaults write com.googlecode.iterm2 PromptOnQuit -bool false

###############################################################################
# Time Machine                                                                #
###############################################################################

# Prevent Time Machine from prompting to use new hard drives as backup volume
defaults write com.apple.TimeMachine DoNotOfferNewDisksForBackup -bool true

# Disable local Time Machine backups
# hash tmutil &> /dev/null && sudo tmutil disablelocal

###############################################################################
# Activity Monitor                                                            #
###############################################################################

# Show the main window when launching Activity Monitor
defaults write com.apple.ActivityMonitor OpenMainWindow -bool true

# Visualize CPU usage in the Activity Monitor Dock icon
# defaults write com.apple.ActivityMonitor IconType -int 5

# Show all processes in Activity Monitor
defaults write com.apple.ActivityMonitor ShowCategory -int 0

# Sort Activity Monitor results by CPU usage
defaults write com.apple.ActivityMonitor SortColumn -string "CPUUsage"
defaults write com.apple.ActivityMonitor SortDirection -int 0

###############################################################################
# Address Book, Dashboard, iCal, TextEdit, and Disk Utility                   #
###############################################################################

# Enable the debug menu in Address Book
# defaults write com.apple.addressbook ABShowDebugMenu -bool true

# Enable Dashboard dev mode (allows keeping widgets on the desktop)
# defaults write com.apple.dashboard devmode -bool true

# Enable the debug menu in iCal (pre-10.8)
# defaults write com.apple.iCal IncludeDebugMenu -bool true

# Use plain text mode for new TextEdit documents
defaults write com.apple.TextEdit RichText -int 0
# Open and save files as UTF-8 in TextEdit
defaults write com.apple.TextEdit PlainTextEncoding -int 4
defaults write com.apple.TextEdit PlainTextEncodingForWrite -int 4

# Enable the debug menu in Disk Utility
# defaults write com.apple.DiskUtility DUDebugMenuEnabled -bool true
# defaults write com.apple.DiskUtility advanced-image-options -bool true

# Auto-play videos when opened with QuickTime Player
defaults write com.apple.QuickTimePlayerX MGPlayMovieOnOpen -bool true

###############################################################################
# Mac App Store                                                               #
###############################################################################

# Enable the WebKit Developer Tools in the Mac App Store
defaults write com.apple.appstore WebKitDeveloperExtras -bool true

# Enable Debug Menu in the Mac App Store
# defaults write com.apple.appstore ShowDebugMenu -bool true

# Enable the automatic update check
defaults write com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true

# Check for software updates daily, not just once per week
defaults write com.apple.SoftwareUpdate ScheduleFrequency -int 1

# Download newly available updates in background
defaults write com.apple.SoftwareUpdate AutomaticDownload -int 1

# Install System data files & security updates
defaults write com.apple.SoftwareUpdate CriticalUpdateInstall -int 1

# Automatically download apps purchased on other Macs
defaults write com.apple.SoftwareUpdate ConfigDataInstall -int 1

# Turn on app auto-update
defaults write com.apple.commerce AutoUpdate -bool true

# Disallow the App Store to reboot machine on macOS updates
defaults write com.apple.commerce AutoUpdateRestartRequired -bool false

###############################################################################
# Photos                                                                      #
###############################################################################

# Prevent Photos from opening automatically when devices are plugged in
defaults -currentHost write com.apple.ImageCapture disableHotPlug -bool true

###############################################################################
# Messages                                                                    #
###############################################################################

# Disable automatic emoji substitution (i.e. use plain text smileys)
defaults write com.apple.messageshelper.MessageController SOInputLineSettings -dict-add "automaticEmojiSubstitutionEnablediMessage" -bool false

# Disable smart quotes as it’s annoying for messages that contain code
defaults write com.apple.messageshelper.MessageController SOInputLineSettings -dict-add "automaticQuoteSubstitutionEnabled" -bool false

# Disable continuous spell checking
defaults write com.apple.messageshelper.MessageController SOInputLineSettings -dict-add "continuousSpellCheckingEnabled" -bool false

###############################################################################
# Google Chrome & Google Chrome Canary                                        #
###############################################################################

# Disable the all too sensitive backswipe on trackpads
defaults write com.google.Chrome AppleEnableSwipeNavigateWithScrolls -bool false
defaults write com.google.Chrome.canary AppleEnableSwipeNavigateWithScrolls -bool false

# Disable the all too sensitive backswipe on Magic Mouse
defaults write com.google.Chrome AppleEnableMouseSwipeNavigateWithScrolls -bool false
defaults write com.google.Chrome.canary AppleEnableMouseSwipeNavigateWithScrolls -bool false

# Use the system-native print preview dialog
# defaults write com.google.Chrome DisablePrintPreview -bool true
# defaults write com.google.Chrome.canary DisablePrintPreview -bool true

# Expand the print dialog by default
# defaults write com.google.Chrome PMPrintingExpandedStateForPrint2 -bool true
# defaults write com.google.Chrome.canary PMPrintingExpandedStateForPrint2 -bool true

###############################################################################
# Kill affected applications                                                  #
###############################################################################

for app in "Activity Monitor" \
  "Address Book" \
  "Calendar" \
  "cfprefsd" \
  "Contacts" \
  "Dock" \
  "Finder" \
  "Mail" \
  "Messages" \
  "Photos" \
  "Safari" \
  "SystemUIServer" \
  "iCal"; do
  killall "${app}" &> /dev/null
done
echo "Done. Note that some of these changes require a logout/restart to take effect."


printf "TO DO:\n\
  Rearrange the Dock\n\
\n\
Restart Terminal.app\n\
copy git config from your backup/re-login \n\
copy .npmrc from your backup/re-login \n\
login to literally everything \n\
"
